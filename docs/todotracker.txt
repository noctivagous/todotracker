todo list python script server launches server
and web browser for adding and editing to do lists
for the project.  and it is complemented with 
an mcp tool that the AI uses to carry out todos 
(and add tasks, subtasks and concerns under any 
todo items).  the system can also have a notes
section.  stores its data in sqlite server.

to do items have built-in categories:
feature (features/functionality), issue, bug.

AI will update a todo list after working on
it with progress, what is left to be done.



### Revised Specs: Integrating Model Context Protocol (MCP)

After researching the **Model Context Protocol (MCP)**—an open standard introduced by Anthropic in November 2024 and now widely adopted—MCP is the ideal foundation for the AI interface in this agentic IDE todo system. MCP standardizes secure, two-way connections between LLMs/AI agents and external tools/data sources, building on function calling but with better context maintenance, resource sharing, and interoperability across models (e.g., Claude, ChatGPT, others).

This replaces the custom REST/Python client approach in the previous specs with a native **MCP server**. Benefits include:
- Native support in many AI hosts (e.g., Cursor, Claude desktop/app, custom agents).
- Standardized tool/resource/prompt exposure—no custom schemas per model.
- Secure, controlled access with user consent flows.
- Better context persistence for multi-turn agent workflows (e.g., AI working on a todo over several steps).

The human web UI remains separate (via REST or direct DB), but the AI interacts exclusively via MCP.

### 1. System Overview (Updated)
- Python backend launches two servers:
  - **MCP Server**: For AI agent interaction (primary for "agentic" part).
  - **Web Server/UI**: For human interaction.
- Data in SQLite.
- Todos categorized as **feature** (features/functionality), **issue**, **bug**.
- AI must update todos with progress/remaining work after tasks.

### 2. Core Components (Revised)

1. **Python MCP Server**
   - Implements the official MCP specification (JSON-RPC over stdio, HTTP, or WebSocket).
   - Use the official Python SDK from https://github.com/modelcontextprotocol (or equivalents).
   - Exposes:
     - **Tools**: Functions the AI can call (e.g., create_todo, update_todo_progress, add_subtask, list_todos).
     - **Resources**: Read-only data snapshots (e.g., full todo tree, specific todo details) for context injection.
     - **Prompts** (optional): Predefined templates like "Summarize progress on this todo".
   - Runs locally (e.g., `python mcp_server.py`).

2. **Web UI (Unchanged but Clarified)**
   - Separate Flask/FastAPI/Streamlit server with REST endpoints.
   - Humans add/edit/view todos/notes via browser.
   - Shares the same SQLite DB (use file locking or a lightweight wrapper for concurrency).

3. **SQLite Database (Unchanged)**
   - Same schema as before (todos table with parent_id for hierarchy, notes table).

### 3. MCP Interface Definition (Key Revision)

The MCP server exposes the following **tools** (as MCP "tools" with JSON schemas):

- `list_todos()` → Returns hierarchical todo tree (nested JSON).
- `get_todo(todo_id: int)` → Full details + children + notes.
- `create_todo(title: str, description: str, category: str, parent_id: int | null)` → New todo/subtask/concern.
- `add_concern(parent_id: int, title: str, description: str)` → Convenience wrapper (prefixes title with "[Concern]").
- `update_todo(todo_id: int, status: str | null, progress_summary: str | null, remaining_work: str | null, title/description/etc.)` → Partial updates.
  - **Mandatory for AI**: After task work, call this with progress_summary and remaining_work.
- `create_note(content: str, todo_id: int | null)` → Add note.
- `search_todos(query: str, category: str | null, status: str | null)` → Filtered list.

**Resources** (for context injection):
- `todos/tree` → Full current todo hierarchy.
- `todos/{id}` → Specific todo + subtree.

This allows the AI to:
- Fetch context (resources) automatically.
- Call tools iteratively.
- Maintain state across turns.

### 4. API for Web UI (Separate from MCP)
- Keep simple REST endpoints (FastAPI recommended) for the browser UI.
- Endpoints mirror MCP tools but HTTP-based (e.g., GET /todos, POST /todos).

### 5. Implementation Path (Updated)
- **Tech Stack**:
  - MCP Server: Official Python SDK + SQLAlchemy/sqlite3.
  - Web UI/Server: FastAPI + HTMX/Tailwind or Streamlit.
- **Starter Structure**:
  ```
  project/
  ├── db.py              # SQLite models/wrapper
  ├── mcp_server.py      # MCP implementation (tools/resources)
  ├── web_server.py      # FastAPI REST + UI templates
  ├── project.db         # SQLite file
  └── todotracker_webserver.py             # Launch both servers
  ```
- **Running**:
  - AI host connects to MCP server (e.g., via HTTP endpoint or stdio).
  - Browser opens http://localhost:8070 for UI.
- **Security**: Local-only by default. MCP has built-in consent prompts.

### 6. AI Behavior Guidelines (Reinforced)
- The agent must use `update_todo` after any work, populating:
  - `progress_summary`: Detailed accomplishment.
  - `remaining_work`: Clear next steps (or empty if done).
  - Status update.
- For subtasks/concerns: Create as child todos; concerns prefixed conventionally.

### 7. Why This Revision Improves the System
- **Interoperability**: Works with any MCP-supporting AI (Claude, etc.) without custom tool defs.
- **Agentic Fit**: Better for long-running tasks with context retention.
- **Future-Proof**: As MCP ecosystem grows (IDEs like Cursor/Replit already integrate it).

If you'd like:
- Sample code for the MCP server (e.g., basic tool implementations).
- Details on running with specific AI hosts.
- Additions like OAuth for multi-user or remote access.

  - **Dependencies**: Add a many-to-many table for task dependencies (e.g., `todo_dependencies` with `todo_id` → `depends_on_id`). Blocks AI from starting a task until prerequisites are done, and UI can visualize with arrows or indent warnings.
 